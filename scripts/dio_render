#!/usr/bin/env bash 
# https://devilgate.org/blog/2012/07/02/tip-using-pandoc-to-create-truly-standalone-html-files
: "${PATH_BASE:="$(git rev-parse --show-toplevel)"}" 
cd "${PATH_BASE}"/content
# https://github.com/pandoc/dockerfiles
for path_dir in $(find -type d -name "*" 2>/dev/null); do
  path_readme="${path_dir:2}"
  file_readme="${path_dir:2}"/README.md
  if [[ -f "${file_readme}" ]]; then
    title=$(basename $(dirname "${file_readme}")) 
    echo "title: ${title}" 
    echo "file_readme: ${file_readme}" 
    echo $(docker run --rm --volume "`pwd`:/data" pandoc/latex:2.6 -s --metadata title="${title}" -H css1.css "${file_readme}") > "${path_readme}"/index.html
  fi 
done
